/**
 * SfGather-js SDK
 * @name SfGather
 * @author 854638,01368384
 * 限制说明：支持ie9及以上
 */
!function(e){function t(){var e=Ce(Y)||[];if(e.length&&e.length>0){for(var t=0;t<e.length;t++)Z.push(e[t]);Ce(z,Z),Ce(Y,ee),e=null}}function n(){a(document,"click",be),a(window,"load",l),a(window,"hashchange",l),window.onerror=c}function i(){if(!e.ignore_visitor){var t=0;if(void 0!==e.onload&&e.onload.length>0){for(t=0;t<e.onload.length;t++)"function"==typeof e.onload[t]&&e.onload[t]();e.onload=[]}if(void 0!==e.q&&e.q.length>0){var n,o=e.q;for(e.q=[],t=0;t<o.length;t++)n=o[t],w("Processing queued call",n),"function"==typeof n?n():n.constructor===Array&&n.length>0&&void 0!==e[n[0]]&&e[n[0]].apply(null,n.slice(1))}if($&&ae&&ye){var r=x();r-B>ve&&(e.session_duration(r-B),B=r)}if(te.length>0){if(1===te.length)te.forEach(function(e){d(e)}),te=[];else{var a=te.splice(0,_e),s={};s.event_id="batch",s.type="batch",s.properties=[],a.forEach(function(e){e.type||(e.type="event"),s.properties.push(e)}),d(s)}Ce(F,te)}if(Z.length>0&&he&&x()>le){he=!1;var u=Z.shift();w("Processing request",u),L(u,function(e,t){w("Request Finished",t,e),e&&(Z.unshift(t),le=x()+fe),Ce(z,Z,!0),he=!0})}setTimeout(i,K)}}function o(e,t){function n(){0==arguments.length?w("超时回调"):(w("请求回调参数："+JSON.stringify(arguments)),arguments[0]||(ee.shift(arguments[1]),Ce(Y,ee))),i||(i=!0,e(arguments))}if(e){var i=!1;return t=isNaN(t)?1e3:t,setTimeout(n,t),n}}function r(e){var t=e.getAttribute("sftag");if(!t)return null;var n=t.split(",");if(0===n.length)return null;for(var i={event_id:"click_auto",tagName:e.tagName.toLowerCase()},o=["id","class"],r=0;r<o.length;r++){e.getAttribute(o[r])&&(i[o[r]]=e.getAttribute(o[r]))}for(var r=0;r<n.length;r++){var a=n[r],s=a.split(":");if(2===s.length){var d=s[0].trim(),u=s[1].trim();"event_id"===d?u&&"null"!==u&&(i.event_id=u):i[d]=u}}return i}function a(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function s(t){t.app_id=e.app_id,t.platform=e.platform,t.device_id=e.device_id,t.cookie_id=R("JSESSIONID")||"",t.sdk="js",t.sdk_name=G,t.sdk_v=J,t.s_w=p(),t.s_h=h(),t.model=j(),t.os=W(),t.os_v=I();var n=H();return t.browser=n.appname,t.browser_v=n.version,t.event_id||(t.event_id="view_default"),t.type||(t.type="event"),t.time||(t.time=y()),t}function d(t){if(!e.ignore_visitor){if(!e.device_id)return void w("device_id is missing");if(!e.url)return void w("url is missing");s(t),Z.length>Q&&Z.shift(),Z.push(t),Ce(z,Z,!0)}}function u(t){var n={};return n.time=y(),t.event_id?(n.event_id=t.event_id,delete t.event_id,n.properties=t):(n.event_id="view_default",n.properties=t),n.page_url=location.href,n.page_ref=document.referrer,P(n),document.getElementsByTagName("title")[0]&&(n.page_name=document.getElementsByTagName("title")[0].innerHTML),e.uid&&(n.uid=e.uid),e.sec_uid&&(n.sec_uid=e.sec_uid),e.login_type&&(n.login_type=e.login_type),n}function c(e,t,n){var i="";void 0!==e&&(i=i+e+"\n"),void 0!==t&&(i+="at "+t),void 0!==n&&(i+=":"+n),i+="\n";try{for(var o=[],r=arguments.callee,a=r.caller;a;)o.push(a.name),a=a.caller;i+=o.join("\n")}catch(e){}b({stack:i,event_id:"error_auto"},!1)}function l(){var t={event_id:"view_page_auto"};window.gatherConfig&&window.gatherConfig._st&&window.gatherConfig._st instanceof Date&&(t.load_time=(new Date).getTime()-window.gatherConfig._st.getTime()),e.add_event(t)}function f(){if(de){var t={event_id:"view_page_duration",name:de,segment:D,dur:x()-ue};e.add_event(t),de=null}}function m(){return de}function g(){return Ce("sf_gather_id")||v()}function v(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})}function _(){var t={};if(t._app_version=e.app_version,t._ua=navigator.userAgent,screen.width){var n=screen.width?parseInt(screen.width):0,i=screen.height?parseInt(screen.height):0;if(0!==n&&0!==i){if(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)n=Math.round(n*window.devicePixelRatio),i=Math.round(i*window.devicePixelRatio);else if(90===Math.abs(window.orientation)){var o=n;n=i,i=o}t._resolution=n+"x"+i}}window.devicePixelRatio&&(t._density=window.devicePixelRatio);var r=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(void 0!==r&&(t._locale=r),void 0!==document.referrer&&document.referrer.length){var a=we.exec(document.referrer);if(a&&a[11]&&a[11]!=window.location.hostname){var s=!1;if(oe&&oe.length)for(var d=0;d<oe.length;d++)try{var u=new RegExp(oe[d]);if(u.test(document.referrer)){w("Ignored:",document.referrer),s=!0;break}}catch(e){}s||(t._store=document.referrer)}}return w("Got metrics",t),t}function p(){var e=window.devicePixelRatio||1,t=Math.round(screen.width*e);return 1242===t&&"ios"===W()&&(t=1080),1082===t&&(t=1080),t}function h(){var e=window.devicePixelRatio||1,t=Math.round(screen.height*e);return 2208===t&&"ios"===W()&&(t=1920),1922===t&&(t=1920),t}function w(){e.debug&&"undefined"!=typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),console.log(Array.prototype.slice.call(arguments).join("\n")))}function x(){return Math.floor((new Date).getTime()/1e3)}function y(){var e=(new Date).getTime();return pe>=e?pe++:pe=e,pe}function b(t,n,i){if(t){i=i||re;var o="";"object"==typeof t?void 0!==t.stack?o=t.stack:(void 0!==t.name&&(o+=t.name+":"),void 0!==t.message&&(o+=t.message+"\n"),void 0!==t.fileName&&(o+="in "+t.fileName+"\n"),void 0!==t.lineNumber&&(o+="on "+t.lineNumber),void 0!==t.columnNumber&&(o+=":"+t.columnNumber)):o=t+"",n=!!n;var r=_(),a={_resolution:r._resolution,_error:o,_app_version:r._app_version,_run:x()-X};a._not_os_specific=!0;var s=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;s&&(a._bat=Math.floor(100*s.level)),void 0!==navigator.onLine&&(a._online=!!navigator.onLine),a._background=!document.hasFocus(),ne.length>0&&(a._logs=ne.join("\n")),ne=[],a._nonfatal=n,a._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||""),void 0!==i&&(a._custom=i);try{var d=document.createElement("canvas"),u=d.getContext("experimental-webgl");a._opengl=u.getParameter(u.VERSION)}catch(e){}var c=t.event_id?t.event_id:"error";e.add_event({error_log:JSON.stringify(a),event_id:c})}}function L(t,n){try{w("Sending XML HTTP request");var i=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null,o=JSON.stringify(t);i.open("POST",e.url+V,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.setRequestHeader("Content-type","text/html; charset=utf-8"),i.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<500?"function"==typeof n&&n(!1,t):4===this.readyState&&(w("Failed Server XML HTTP request",this.status),"function"==typeof n&&n(!0,t))},i.send(o)}catch(e){w("Failed XML HTTP request",e),"function"==typeof n&&n(!0,t)}}function k(e){var t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function C(e){return"/"==e.substr(e.length-1)?e.substr(0,e.length-1):e}function O(e,t){for(var n,i={},o=0;o<t.length;o++)n=t[o],void 0!==e[n]&&(i[n]=e[n]);return i}function S(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function N(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function T(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function E(e){Ce("sf_gather_token",e)}function M(){var e=Ce("sf_gather_token");return Ce("sf_gather_token",null),e}function A(e){return void 0===e}function R(e){for(var t=e+"=",n=document.cookie.split(";"),i=0,o=n.length;i<o;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function q(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}function P(e){q("utm_source")&&(e.utm_source=q("utm_source")),q("utm_medium")&&(e.utm_medium=q("utm_medium")),q("utm_term")&&(e.utm_term=q("utm_term")),q("utm_content")&&(e.utm_content=q("utm_content")),q("utm_campaign")&&(e.utm_campaign=q("utm_campaign"))}function H(){var e={appname:"unknown",version:0},t=window.navigator.userAgent.toLowerCase();return/(msie|firefox|opera|chrome|netscape)\D+(\d[\d.]*)/.test(t)?(e.appname=RegExp.$1,e.version=RegExp.$2):/version\D+(\d[\d.]*).*safari/.test(t)&&(e.appname="safari",e.version=RegExp.$2),e}function W(e){return e=e||navigator.userAgent,/(Windows NT 10.0|Windows 10)/i.test(e)?"windows 10":/(Windows NT 6.3|Windows 8.1)/i.test(e)?"windows 8.1":/(Windows NT 6.2|Windows 8)/i.test(e)?"windows 8":/(Windows NT 6.1|Windows 7)/i.test(e)?"windows 7":/Windows NT 6.0/i.test(e)?"windows vista":/Windows NT 5.2/i.test(e)?"windows 2003":/Windows NT 5.1/i.test(e)?"windows xp":/Windows NT 5.0/i.test(e)?"windows 2000":/(iPhone|iPad|iPod|iOS)/i.test(e)?"ios":/android/i.test(e)?"android":/linux/i.test(e)?"linux":/(macintosh|mac os x)/i.test(e)?"mac os":""}function I(e){e=e||navigator.userAgent;var t=W(e);if("android"===t){if(/android\s+(\d+(.\d+)*)/i.test(e))return RegExp.$1}else if("ios"===t&&/cpu\s+(?:iphone\s+)?os\s+(\d+(_\d+)*)/i.test(e))return RegExp.$1.replace(/_/g,".");return""}function j(e){return e=e||navigator.userAgent,"android"===W(e)&&/android\s+\d+(?:.\d+)*;\s+(.+)\s+build/i.test(e)?RegExp.$1:""}var B,D,X,J="1.0.6",G="SfGather-js",Y="sf_gather_queue_page",z="sf_gather_queue",F="sf_gather_event",U=!1,$=!1,V="",K=500,Q=1e3,Z=[],ee=[],te=[],ne=[],ie={},oe=[],re=null,ae=!0,se=0,de=null,ue=0,ce=0,le=0,fe=60,me=20,ge=0,ve=60,_e=10,pe=0,he=!0,we=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,xe=/(SfGatherSiteBot|nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,ye=!0;e.init=function(o){if(!U&&(X=x(),U=!0,ie={},o=o||{},K=o.interval||e.interval||K,Q=o.queue_size||e.queue_size||Q,fe=o.fail_timeout||e.fail_timeout||fe,me=o.inactivity_time||e.inactivity_time||me,ve=o.session_update||e.session_update||ve,_e=o.max_events||e.max_events||_e,e.app_id=o.app_id||e.app_id||"",e.device_id=o.device_id||e.device_id||g(),e.url=C(o.url||e.url||"http://218.17.248.243:40021/json_data"),e.platform=o.platform||e.platform||"pc",e.app_version=o.app_version||e.app_version||"0.0",e.uid=o.uid||e.uid||null,e.sec_uid=o.sec_uid||e.sec_uid||null,e.login_type=o.login_type||e.login_type||null,e.debug=o.debug||e.debug||!1,e.ignore_bots=o.ignore_bots||e.ignore_bots||!0,e.ignore_visitor=o.ignore_visitor||e.ignore_visitor||!1,e.ignore_prefetch=o.ignore_prefetch||e.ignore_prefetch||!0,e.force_post=o.force_post||e.force_post||!1,e.q=e.q||[],e.onload=e.onload||[],te=Ce(F)||[],Z=Ce(z)||[],t(),o.ignore_referrers&&o.ignore_referrers.constructor===Array?oe=o.ignore_referrers:e.ignore_referrers&&e.ignore_referrers.constructor===Array&&(oe=e.ignore_referrers),""===e.url&&(w("Please provide server URL"),e.ignore_visitor=!0),e.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(e.ignore_visitor=!0),e.ignore_bots&&xe.test(navigator.userAgent)&&(e.ignore_visitor=!0),window.name&&0===window.name.indexOf("sf_gather:")?e.passed_data=JSON.parse(window.name.replace("sf_gather:","")):location.hash&&0===location.hash.indexOf("#sf_gather:")&&(e.passed_data=JSON.parse(location.hash.replace("#sf_gather:",""))),e.passed_data&&e.passed_data.token&&e.passed_data.purpose&&(e.passed_data.token!=Ce("sf_gather_old_token")&&(E(e.passed_data.token),Ce("sf_gather_old_token",e.passed_data.token)),"heatmap"===e.passed_data.purpose&&(e.ignore_visitor=!0,showLoader(),loadJS(e.url+"/views/heatmap.js",hideLoader))),n(),!e.ignore_visitor&&(w("SfGather initialized"),e.onload.constructor!==Array&&(e.onload=[]),e.q.constructor!==Array&&(e.q=[]),i(),Ce("sf_gather_id",e.device_id),location.search)))for(var r=location.search.substring(1).split("&"),a=0;a<r.length;a++){var s=r[a].split("=");"sf_gather_id"==s[0]?Ce("sf_gather_cmp_id",s[1]):"sf_gather_uid"==s[0]&&Ce("sf_gather_cmp_uid",s[1])}},e.sendDataDirect=function(t,n,i){if(!e.ignore_visitor&&t&&"function"==typeof t){if(!e.device_id)return void w("device_id is missing");if(!e.url)return void w("url is missing");if(n){var r=s(u(n));ee.push(r),Ce(Y,ee),L(r,o(t,i))}else o(t,i)}};var be=function(t){var n=Le(t),i=r(n);i&&e.q.push(["add_event",i])};e.begin_session=function(t){if(!$){w("Session started"),B=x(),$=!0,ae=!t;var n={};n.begin_session=1,n.event_id="session",e.add_event(n)}},e.set_login_info=function(t,n,i){t&&(e.uid=t),n&&(e.sec_uid=n),i&&(e.login_type=i)},e.session_duration=function(t){$&&(w("Session extended",t),e.add_event({session_duration:t,event_id:"session_duration"}))},e.end_session=function(t){$&&(t=t||x()-B,w("Ending session"),f(),$=!1,e.add_event({event_id:"session",end_session:1,session_duration:t}))},e.change_id=function(t,n){if(e.device_id!=t){n||(e.end_session(),ie={});var i=e.device_id;e.device_id=t,Ce("sf_gather_id",e.device_id),w("Changing id"),n?d({old_device_id:i}):e.begin_session(!ae)}},e.add_event=function(e){te.push(u(e)),Ce(F,te)},e.start_event=function(e){if(ie[e])return void w("Timed event with key "+e+" already started");ie[e]=x()},e.end_event=function(t){"string"==typeof t&&(t={key:t}),t.dur=x()-ie[t.key],e.add_event(t),delete ie[t.key]},e.user_details=function(e){w("Adding userdetails: ",e);var t=["name","username","email","organization","phone","picture","gender","byear","custom"];d({user_details:JSON.stringify(O(e,t))})},e.track_errors=function(e,t){b(e,!0,t)},e.add_log=function(e){ne.push(e)},e.stop_time=function(){ye&&(ye=!1,se=x()-B,ce=x()-ue)},e.start_time=function(){ye||(ye=!0,B=x()-se,ue=x()-ce,ce=0)},e.track_sessions=function(){function t(){document[i]?e.stop_time():e.start_time()}function n(){ge>=me&&e.start_time(),ge=0}e.begin_session(),e.start_time(),a(window,"beforeunload",function(){e.end_session()}),a(window,"unload",function(){e.end_session()});var i="hidden";i in document?document.addEventListener("visibilitychange",t):(i="mozHidden")in document?document.addEventListener("mozvisibilitychange",t):(i="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",t):(i="msHidden")in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?(a(window,"focusin",function(){e.start_time()}),a(window,"focusout",function(){e.stop_time()})):(a(window,"focus",function(){e.start_time()}),a(window,"blur",function(){e.stop_time()}),a(window,"pageshow",function(){e.start_time()}),a(window,"pagehide",function(){e.stop_time()})),a(window,"mousemove",n),a(window,"click",n),a(window,"keydown",n),a(window,"scroll",n),setInterval(function(){++ge>=me&&e.stop_time()},6e4)},e.track_pageview=function(t,n){if(f(),t&&t.constructor===Array&&(n=t,t=null),t=t||window.location.pathname,n&&n.length)for(var i=0;i<n.length;i++)try{var o=new RegExp(n[i]);if(o.test(t))return void w("Ignored:",t)}catch(e){}de=t,ue=x();var r={name:t,visit:1,domain:window.location.hostname};if(void 0!==document.referrer&&document.referrer.length){var a=we.exec(document.referrer);a&&a[11]&&a[11]!=window.location.hostname&&(r.start=1)}r.event_id="view_page",e.add_event(r)},e.track_clicks=function(t,n){function i(t){if(o){if(o=!1,S(t),void 0!==t.pageX&&void 0!==t.pageY){var i,r=N(),a=T(),s={type:"click",x:t.pageX,y:t.pageY,width:a,height:r,domain:window.location.hostname};i=n?Object.assign(n,s):s,i.event_id="click",e.add_event(i)}setTimeout(function(){o=!0},1e3)}}t=t||document;var o=!0;a(t,"click",i)},e.track_links=function(t){function n(t){var n=Le(t).closest("a");if(n&&(S(t),e.add_event({event_id:"click_link",href:n.href,text:n.innerText,id:n.id,x:t.pageX,y:t.pageY}),void 0!==n.href&&"_blank"!==n.target&&!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey))){0!==n.href.replace(window.location.href.split("#")[0],"").indexOf("#")&&e.end_session()}}t=t||document,a(t,"click",n)},e.track_forms=function(t){function n(e){return e.name||e.id||e.type||e.nodeName}function i(t){var i,o=Le(t),r={id:o.id,name:o.name,action:o.action,method:o.method};if(void 0!==o.elements)for(var a=0;a<o.elements.length;a++)if((i=o.elements[a])&&"password"!=i.type)if(void 0===r["input:"+n(i)]&&(r["input:"+n(i)]=[]),"select"==i.nodeName.toLowerCase())if(void 0!==i.multiple){var s=[];if(void 0!==i.options)for(var d=0;d<i.options.length;d++)i.options[d].selected&&s.push(i.options[d].value);r["input:"+n(i)].push(s.join(", "))}else r["input:"+n(i)].push(i.options[i.selectedIndex].value);else"input"==i.nodeName.toLowerCase()?void 0!==i.type&&("checkbox"==i.type.toLowerCase()||"radio"==i.type.toLowerCase())?i.checked&&r["input:"+n(i)].push(i.value):r["input:"+n(i)].push(i.value):"textarea"==i.nodeName.toLowerCase()?r["input:"+n(i)].push(i.value):void 0!==i.value&&r["input:"+n(i)].push(i.value);for(var u in r)void 0!==r[u].join&&(r[u]=r[u].join(", "));r.event_id="formSubmit",e.add_event(r),e.end_session()}t=t||document,a(t,"submit",i)},e.collect_from_forms=function(t,n){function i(i){var o,r=Le(i),a={},s=!1;if(void 0!==r.elements){var d,u,c={},l=t.getElementsByTagName("LABEL");for(d=0;d<l.length;d++)l[d].htmlFor&&""!==l[d].htmlFor&&(c[l[d].htmlFor]=l[d].innerText||l[d].textContent||l[d].innerHTML);for(d=0;d<r.elements.length;d++)if((o=r.elements[d])&&"password"!=o.type&&-1==o.className.indexOf("sf_gather_user_ignore")){var f="";if("select"==o.nodeName.toLowerCase())if(void 0!==o.multiple){var m=[];if(void 0!==o.options)for(u=0;u<o.options.length;u++)o.options[u].selected&&m.push(o.options[u].value);f=m.join(", ")}else f=o.options[o.selectedIndex].value;else"input"==o.nodeName.toLowerCase()?void 0!==o.type&&("checkbox"==o.type.toLowerCase()||"radio"==o.type.toLowerCase())?o.checked&&(f=o.value):f=o.value:"textarea"==o.nodeName.toLowerCase()?f=o.value:void 0!==o.value&&(f=o.value);if(o.className&&-1!=o.className.indexOf("sf_gather_user_")){var g=o.className.split(" ");for(u=0;u<g.length;u++)if(0===g[u].indexOf("sf_gather_user_")){a[g[u].replace("sf_gather_user_","")]=f,s=!0;break}}else o.type&&"email"==o.type.toLowerCase()||o.name&&-1!=o.name.toLowerCase().indexOf("email")||o.id&&-1!=o.id.toLowerCase().indexOf("email")||o.id&&c[o.id]&&-1!=c[o.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(f)?(a.email||(a.email=f),s=!0):o.name&&-1!=o.name.toLowerCase().indexOf("username")||o.id&&-1!=o.id.toLowerCase().indexOf("username")||o.id&&c[o.id]&&-1!=c[o.id].toLowerCase().indexOf("username")?(a.username||(a.username=f),s=!0):o.name&&(-1!=o.name.toLowerCase().indexOf("tel")||-1!=o.name.toLowerCase().indexOf("phone")||-1!=o.name.toLowerCase().indexOf("number"))||o.id&&(-1!=o.id.toLowerCase().indexOf("tel")||-1!=o.id.toLowerCase().indexOf("phone")||-1!=o.id.toLowerCase().indexOf("number"))||o.id&&c[o.id]&&(-1!=c[o.id].toLowerCase().indexOf("tel")||-1!=c[o.id].toLowerCase().indexOf("phone")||-1!=c[o.id].toLowerCase().indexOf("number"))?(a.phone||(a.phone=f),s=!0):o.name&&(-1!=o.name.toLowerCase().indexOf("org")||-1!=o.name.toLowerCase().indexOf("company"))||o.id&&(-1!=o.id.toLowerCase().indexOf("org")||-1!=o.id.toLowerCase().indexOf("company"))||o.id&&c[o.id]&&(-1!=c[o.id].toLowerCase().indexOf("org")||-1!=c[o.id].toLowerCase().indexOf("company"))?(a.organization||(a.organization=f),s=!0):(o.name&&-1!=o.name.toLowerCase().indexOf("name")||o.id&&-1!=o.id.toLowerCase().indexOf("name")||o.id&&c[o.id]&&-1!=c[o.id].toLowerCase().indexOf("name"))&&(a.name||(a.name=""),a.name+=f+" ",s=!0)}}s&&(w("Gathered user data",a),n?e.user_details({custom:a}):e.user_details(a)),e.end_session()}t=t||document,a(t,"submit",i)},Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;for(e=e.toUpperCase();t;){if(t.nodeName.toUpperCase()==e)return t;t=t.parentElement}});var Le=function(e){return e?void 0!==e.target?e.target:e.srcElement:window.event.srcElement},ke=function(e,t,n){function i(e,t,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString();document.cookie=e+"="+t+o+"; path=/"}n=n||!1;var o,r=!1;if("undefined"!=typeof localStorage){r=!0;try{localStorage.setItem("testLocal",!0)}catch(e){r=!1}}if(void 0!==t&&null!==t&&("object"==typeof t&&(t=JSON.stringify(t)),r?localStorage.setItem(e,t):n||i(e,t,30)),void 0===t){r?o=localStorage.getItem(e):n||(o=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0,o=n.length;i<o;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}(e));try{o=JSON.parse(o)}catch(e){o=o}return o}null===t&&(r?localStorage.removeItem(e):n||i(e,"",-1))},Ce=function(t,n){var i=e.app_id;if("string"==typeof i&&"string"==typeof t&&0!==t.trim().length){var o=ke(i)||{};if(A(n)){var r=o[t];return r||null}o[t]=n,ke(i,o)}};e._internals={store:Ce,getDocWidth:T,getDocHeight:N,get_page_coord:S,get_event_target:Le,getProperties:O,stripTrailingSlash:C,prepareParams:k,sendXmlHttpRequest:L,recordError:b,getMsTimestamp:y,getTimestamp:x,log:w,getMetrics:_,generateUUID:v,getId:g,heartBeat:i,toRequestQueue:d,reportViewDuration:f,getLastView:m,setToken:E,getToken:M,getQueryString:q,getUtmData:P,getBrowserInfo:H}}(window.SfGather=window.SfGather||{});